(datatype EXP
  (CONST i64)
  (ADD EXP EXP))
(rewrite (ADD (CONST a) (CONST b)) (CONST (+ a b)))
  
(datatype PATTERN
  (EXACT i64) ; idea: hashconsed constant?
  (TRUE)
  (FALSE)
  (BOTH PATTERN PATTERN))

(datatype KEYS
  (KEY i64 KEYS) ; idea: hashconsed identifier?
  (KNIL))

(datatype ACTION
  (SET i64  ; var
       i64) ; val
  (SKIP))

(datatype RULES
  (RULE PATTERN ACTION RULES)
  (RNIL))

(datatype TABLE
  (map i64 ACTION))

(datatype PROG
  (CONS TABLE PROG)
  (PNIL))
